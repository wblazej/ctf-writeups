from Crypto.Util.number import long_to_bytes
from sympy.ntheory.modular import crt


def integer_cube_root(n):
    low = 0
    high = n
    while low < high:
        mid = (low + high) // 2
        if mid**3 < n:
            low = mid + 1
        else:
            high = mid
    return low


c = [
    36814493191278922583664548796049473002934225783698542289397725607847183340609664212180478330488901523860236647284278213863772663388364650557983135407513674736268321336785812329944475031850481788339293039177313822526718229543432497038748366060729196422011515271185680722346707139988102116334658326166068914349,
    136014667564068592195621262914039484124173576723662209544412387104765587155978769326939390251122676151460789149224215536348065442848506217077732661781855644007752154579048613354584490372861212197324010769418785937601447776731618977673371593786812188511506615971561853119359414338690326043765045952766567754366,
    40893562502348035099068153502238020194555278428899087681495256406386391082292975756942120424631522109633517940649326682590280483449659013757054615328815505392540636620804867544629652937193948333108321542551757092505942030072979069383707397395885405597416690978548060571651690752847838401879610449580460733721
]

n = [
    77356739685825488260629812938740679387325174104677035653364870079639770027891541884143630445437672502672326603432125745357517076220316790539165423316025282721578347513032968266316923895086492311775899884861725949779026671566186599380992703341890005887643360647211896411636029582697022293725932057809276461471,
    144366476707306680532292062825410732239122389354355613799125055355739580507964127985401432498241278873238945314327151150904929525071052674310746906244700234803269915420801611069831304870795696254640580403637877926221640615230107939459595337949653636590370888821347701172699625689942476663111661509590313385913,
    107448315048928823997972387644868239009781099443179432262628950526955387933096594266748240208871454500395567965672259909149519940847714980684915085341249692766704413838702747859442537943570379330912168645196791196376893195526066150696780291786132475278664450812807334330154526232212668561802349781460079223719
]

combined_c, combined_n = crt(n, c)

m_cubed = combined_c % combined_n
m = integer_cube_root(m_cubed)

print(long_to_bytes(m))
